<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>サービス実施記録（Thumbelina／スマホ版）</title>

<!-- ✅ PDF生成ライブラリ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  :root {
    --gap: 12px;
    --radius: 10px;
    --border: 1px solid #ddd;
  }
  * { box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
    margin: 0;
    padding: 20px;
    line-height: 1.5;
    color: #222;
    background: #fafafa;
  }
  h1 {
    font-size: 1.2rem;
    margin: 0 0 14px;
  }
  .card {
    background: #fff;
    border: var(--border);
    border-radius: var(--radius);
    padding: 14px;
    margin-bottom: 16px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.04);
  }
  .row {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--gap);
  }
  .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  .grid-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
  .field label {
    font-weight: 600;
    display: block;
    margin-bottom: 4px;
  }
  .inline {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 14px;
    align-items: center;
  }
  .inline .group { display: inline-flex; align-items: center; gap: 8px; }
  input[type="text"], input[type="number"], input[type="datetime-local"], textarea {
    width: 100%;
    border: var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    font-size: 16px;
    background: #fff;
  }
  textarea { min-height: 120px; resize: vertical; }
  .muted { color: #666; font-size: 0.9em; }
  .actions {
    position: sticky; bottom: 12px;
    background: linear-gradient(180deg, rgba(250,250,250,0), #fafafa 30%);
    padding-top: 8px; margin-top: 8px;
  }
  .btn {
    appearance: none;
    border: none;
    border-radius: 10px;
    padding: 12px 16px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
  }
  .btn-primary {
    background: #0d6efd;
    color:#fff;
    width: 100%;
    margin-top: 20px;
  }
  .btn-outline {
    background: transparent;
    border: 1px solid #0d6efd;
    color: #0d6efd;
  }
  .section-title {
    font-weight: 700;
    margin-bottom: 8px;
    font-size: 1.05rem;
  }
  .chip {
    display: inline-flex; align-items: center; gap: 6px;
    padding: 6px 10px; border-radius: 999px; background: #f2f4f7; border: 1px solid #e6e9ef;
  }
  .text-right {
    text-align: right;
  }

  /* 印刷用 */
  @media print {
    body { background: #fff; padding: 0; }
    .actions { display: none; }
    .btn-primary { display: none; }
    .card { box-shadow: none; border-color: #bbb; }
  }
	#pdf_memo {
  display: block;
  white-space: pre-wrap;
  line-height: 1.6;
}
	.pdf-weather-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;   /* 好みで調整してOK */
  margin-bottom: 20px;
  align-items: center;
}

.pdf-weather-row div {
  display: flex;
  gap: 6px;
  white-space: nowrap; /* 改行防止 */
}
	.pdf-two-row {
  display: flex;
  gap: 40px;      /* 間隔は自由に調整OK */
  align-items: center;
  margin-bottom: 20px;
}
.pdf-two-row div {
  display: flex;
  gap: 6px;
  white-space: nowrap;
}
@media print {
  @page {
    margin: 0;
  }
}


</style>
</head>
<body>
  <h1>サービス実施記録（Thumbelina／スマホ版）</h1>

  <form id="recordForm">
    <div class="card">
		<div class="row">
		  <div class="field">
		    <label for="name">お名前</label>
		    <input id="name" name="name" type="text" placeholder="ペットのお名前">
		  </div>

		  <div class="field">
		    <label for="enter_time">入室時間</label>
		    <input id="enter_time" name="enter_time" type="datetime-local">
		  </div>

		  <div class="field">
		    <label for="exit_time">退室時間</label>
		    <input id="exit_time" name="exit_time" type="datetime-local">
		  </div>
		</div>
    </div>

    <div class="card">
      <div class="section-title">天候・環境</div>
      <div class="row">
        <div class="inline">
          <span class="chip"><input type="checkbox" id="weather_sunny" name="weather_sunny"><label for="weather_sunny">晴れ</label></span>
          <span class="chip"><input type="checkbox" id="weather_cloudy" name="weather_cloudy"><label for="weather_cloudy">くもり</label></span>
          <span class="chip"><input type="checkbox" id="weather_rainy" name="weather_rainy"><label for="weather_rainy">雨</label></span>
        </div>
        <div class="row grid-3">
          <div class="field">
            <label for="temp_out">外気温（℃）</label>
            <input id="temp_out" name="temp_out" type="number" inputmode="decimal" step="0.1" placeholder="例）25.5">
          </div>
          <div class="field">
            <label for="temp_in">室温（℃）</label>
            <input id="temp_in" name="temp_in" type="number" inputmode="decimal" step="0.1">
          </div>
          <div class="field">
            <label for="humidity">湿度（％）</label>
            <input id="humidity" name="humidity" type="number" inputmode="numeric" step="1" min="0" max="100">
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">サービスの種類</div>
      <div class="inline">
        <span class="chip"><input type="radio" id="service_0" name="service" value="30"><label for="service_0">シッティング30分</label></span>
        <span class="chip"><input type="radio" id="service_1" name="service" value="60"><label for="service_1">シッティング60分</label></span>
        <span class="chip"><input type="radio" id="service_2" name="service" value="90"><label for="service_2">シッティング90分</label></span>
        <span class="chip"><input type="radio" id="service_3" name="service" value="120"><label for="service_3">シッティング120分</label></span>
        <span class="chip">
          <input type="radio" id="service_other_chk" name="service" value="other">
          <label for="service_other_chk">その他</label>
        </span>
        <input id="service_other_text" name="service_other_text" type="text" placeholder="その他：内容を記入" aria-label="その他内容" style="flex:1; min-width: 200px;">
      </div>
    </div>

    <div class="card">
      <div class="section-title">排泄</div>
      <div class="row">
        <div class="field">
          <label>おしっこ</label>
          <div class="inline">
            <span class="group"><input type="radio" id="pee_low" name="pee" value="少量"><label for="pee_low">少量</label></span>
            <span class="group"><input type="radio" id="pee_mid" name="pee" value="中量"><label for="pee_mid">中量</label></span>
            <span class="group"><input type="radio" id="pee_high" name="pee" value="多量"><label for="pee_high">多量</label></span>
            <span class="group"><input type="radio" id="pee_none" name="pee" value="なし"><label for="pee_none">なし</label></span>
            <input type="text" id="pee_note" name="pee_note" placeholder="メモ（色・回数など）">
          </div>
        </div>

        <div class="field">
          <label>うんち</label>
          <div class="inline">
            <span class="group"><input type="radio" id="poo_low" name="poo" value="少量"><label for="poo_low">少量</label></span>
            <span class="group"><input type="radio" id="poo_mid" name="poo" value="中量"><label for="poo_mid">中量</label></span>
            <span class="group"><input type="radio" id="poo_high" name="poo" value="多量"><label for="poo_high">多量</label></span>
            <span class="group"><input type="radio" id="poo_none" name="poo" value="なし"><label for="poo_none">なし</label></span>
            <input type="text" id="poo_note" name="poo_note" placeholder="メモ（状態・回数など）">
          </div>
        </div>

        <div class="inline">
          <span class="chip"><input type="checkbox" id="toilet_clean_yes" name="toilet_clean" value="実施"><label for="toilet_clean_yes">トイレ掃除：実施</label></span>
          <span class="chip"><input type="checkbox" id="toilet_clean_no" name="toilet_clean_no" value="未実施"><label for="toilet_clean_no">トイレ掃除：未実施</label></span>
          <span class="chip"><input type="checkbox" id="sheet_yes" name="sheet" value="あり"><label for="sheet_yes">シート交換：あり</label></span>
          <span class="chip"><input type="checkbox" id="sheet_no"  name="sheet_no" value="なし"><label for="sheet_no">シート交換：なし</label></span>
          <span class="chip"><input type="checkbox" id="sand_yes" name="sand" value="あり"><label for="sand_yes">砂の補充：あり</label></span>
          <span class="chip"><input type="checkbox" id="sand_no"  name="sand_no" value="なし"><label for="sand_no">砂の補充：なし</label></span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">食事・水分</div>
      <div class="row">
        <div class="field">
          <label>ごはん</label>
          <div class="inline">
            <span class="group"><input type="checkbox" id="food_dry" name="food_dry"><label for="food_dry">ドライ</label></span>
            <span class="group"><input type="checkbox" id="food_wet" name="food_wet"><label for="food_wet">ウェット</label></span>
            <input type="text" id="food_note" name="food_note" placeholder="銘柄・量など">
          </div>
        </div>
        <div class="field">
          <label>おやつ</label>
          <div class="inline">
			<span class="group"><input type="radio" id="snack_all"  name="snack" value="あり"><label for="snack_all">あり</label></span>
            <span class="group"><input type="radio" id="snack_none" name="snack" value="なし"><label for="snack_none">なし</label></span>
            <input type="text" id="snack_note" name="snack_note" placeholder="内容・量など">
          </div>
        </div>
        <div class="field">
          <label>お水</label>
          <div class="inline">
            <span class="group"><input type="radio" id="water_changed" name="water" value="交換済み"><label for="water_changed">交換済み</label></span>
            <span class="group"><input type="radio" id="water_not" name="water" value="未交換"><label for="water_not">未交換</label></span>
            <input type="text" id="water_note" name="water_note" placeholder="器の数・場所など">
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">ケア</div>
      <div class="row">
        <div class="inline">
          <span class="chip"><input type="radio" id="walk_done" name="walk" value="実施"><label for="walk_done">お散歩：実施</label></span>
          <span class="chip"><input type="radio" id="walk_none" name="walk" value="未実施"><label for="walk_none">お散歩：未実施</label></span>
        </div>
        <div class="inline">
          <span class="chip"><input type="radio" id="brush_yes" name="brush" value="実施"><label for="brush_yes">ブラッシング：実施</label></span>
          <span class="chip"><input type="radio" id="brush_no"  name="brush" value="未実施"><label for="brush_no">ブラッシング：未実施</label></span>
          <span class="group" style="margin-left:6px;">
            <span class="muted">抜け毛の量</span>
            <span class="group"><input type="radio" id="fur_low" name="fur" value="少量"><label for="fur_low">少量</label></span>
            <span class="group"><input type="radio" id="fur_mid" name="fur" value="中量"><label for="fur_mid">中量</label></span>
            <span class="group"><input type="radio" id="fur_high" name="fur" value="多量"><label for="fur_high">多量</label></span>
          </span>
        </div>
        <div class="inline">
          <span class="chip"><input type="radio" id="meds_done" name="meds" value="済み"><label for="meds_done">服薬：済み</label></span>
          <span class="chip"><input type="radio" id="meds_none" name="meds" value="なし"><label for="meds_none">服薬：なし</label></span>
          <span class="chip"><input type="radio" id="topical_done" name="topical" value="済み"><label for="topical_done">塗布薬：済み</label></span>
          <span class="chip"><input type="radio" id="topical_none" name="topical" value="なし"><label for="topical_none">塗布薬：なし</label></span>
          <span class="chip"><input type="radio" id="nail_done" name="nail" value="実施"><label for="nail_done">爪切り：実施</label></span>
          <span class="chip"><input type="radio" id="nail_none" name="nail" value="未実施"><label for="nail_none">爪切り：未実施</label></span>
		  <span class="chip"><input type="radio" id="tooth_done" name="tooth" value="実施"><label for="tooth_done">歯磨き：実施</label></span>
          <span class="chip"><input type="radio" id="tooth_none" name="tooth" value="未実施"><label for="tooth_none">歯磨き：未実施</label></span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">MEMO</div>
      <textarea id="memo" name="memo" placeholder="全体のご様子・特記事項など"></textarea>
    </div>

    <h2 class="text-right">ペットの訪問介護・Thumbelina</h2>

    <!-- ✅ PDF保存ボタン（指定の位置=最下部） -->
    <button type="button" class="btn btn-primary" onclick="saveAsPDF()">
      PDFとして保存
    </button>
	<!-- ✅ PDF用の非表示領域 -->
	<div id="pdfContent"
   style="
     display:none;
     width: 794px;       /* ← A4の幅に相当 */
	 min-height: 1123px;
     padding:80px 40px; 
     font-size: 24px;    /* PDF用の文字サイズ（自由に調整OK） */
     line-height: 1.6;
   ">

	  <h2>サービス実施記録</h2>
	  <p><strong>お名前：</strong> <span id="pdf_name"></span></p>
	  <p><strong>入室時間：</strong> <span id="pdf_enter_time"></span></p>
	  <p><strong>退室時間：</strong> <span id="pdf_exit_time"></span></p>

	  <h3>天候・環境</h3>
	  <div class="pdf-weather-row">
       <div><strong>天候：</strong><span id="pdf_weather"></span></div>
       <div><strong>外気温：</strong><span id="pdf_temp_out"></span></div>
       <div><strong>室温：</strong><span id="pdf_temp_in"></span></div>
       <div><strong>湿度：</strong><span id="pdf_humidity"></span></div>
      </div>

	  <h3>サービスの種類</h3>
	  <p id="pdf_service"></p>

	  <h3>排泄</h3>
	  <p><strong>おしっこ：</strong> <span id="pdf_pee"></span></p>
	  <p><strong>うんち：</strong> <span id="pdf_poo"></span></p>
	  <p><strong>その他ケア：</strong> <span id="pdf_toilet"></span></p>

	  <h3>食事・水分</h3>
	  <p><strong>ごはん：</strong> <span id="pdf_food"></span></p>
	  <p><strong>おやつ：</strong> <span id="pdf_snack"></span></p>
	  <p><strong>お水：</strong> <span id="pdf_water"></span></p>

	  <h3>ケア</h3>
	  <p><strong>お散歩：</strong> <span id="pdf_walk"></span></p>
	  <div class="pdf-two-row">
       <div><strong>ブラッシング：</strong><span id="pdf_brush"></span></div>
       <div><strong>抜け毛：</strong><span id="pdf_fur"></span></div>
      </div>
	  <div class="pdf-two-row">
       <div><strong>服薬：</strong><span id="pdf_meds"></span></div>
       <div><strong>塗布薬：</strong><span id="pdf_topical"></span></div>
      </div>
	  <div class="pdf-two-row">
       <div><strong>爪切り：</strong><span id="pdf_nail"></span></div>
       <div><strong>歯磨き：</strong><span id="pdf_tooth"></span></div>
      </div>


	  <h3>MEMO</h3>
	  <p id="pdf_memo"></p>

	  <p style="text-align:right; margin-top:40px;">ペットの訪問介護・Thumbelina</p>
		<div style="height:80px;"></div>
	</div>


  </form>

  <script>
  async function saveAsPDF() {
    const { jsPDF } = window.jspdf;

    // ✅ 入力内容をPDF専用領域に流し込む
    document.getElementById("pdf_name").innerText = document.getElementById("name").value;
	// ✅ 入室・退室
	document.getElementById("pdf_enter_time").innerText = document.getElementById("enter_time").value;
	document.getElementById("pdf_exit_time").innerText = document.getElementById("exit_time").value;


    // 天候
    let weather = [];
	if (document.getElementById("weather_sunny").checked) weather.push("晴れ");
	if (document.getElementById("weather_cloudy").checked) weather.push("くもり");
	if (document.getElementById("weather_rainy").checked) weather.push("雨");
    document.getElementById("pdf_weather").innerText = weather.join("・");

    document.getElementById("pdf_temp_out").innerText = document.getElementById("temp_out").value + "℃";
    document.getElementById("pdf_temp_in").innerText = document.getElementById("temp_in").value + "℃";
    document.getElementById("pdf_humidity").innerText = document.getElementById("humidity").value + "%";

    // サービス種類
    const service = document.querySelector("input[name='service']:checked");
    let serviceText = service ? service.nextElementSibling.innerText : "";
    if (service && service.value === "other")
      serviceText = document.getElementById("service_other_text").value;
    document.getElementById("pdf_service").innerText = serviceText;

    // 排泄
    const pee = document.querySelector("input[name='pee']:checked");
    document.getElementById("pdf_pee").innerText =
      (pee ? pee.nextElementSibling.innerText : "") +
      " " + document.getElementById("pee_note").value;

    const poo = document.querySelector("input[name='poo']:checked");
    document.getElementById("pdf_poo").innerText =
      (poo ? poo.nextElementSibling.innerText : "") +
      " " + document.getElementById("poo_note").value;

    let toilet = [];

if (document.getElementById("toilet_clean_yes").checked) toilet.push("トイレ掃除:実施");
if (document.getElementById("toilet_clean_no").checked) toilet.push("トイレ掃除:未実施");
if (document.getElementById("sheet_yes").checked) toilet.push("シート交換:あり");
if (document.getElementById("sheet_no").checked) toilet.push("シート交換:なし");
if (document.getElementById("sand_yes").checked) toilet.push("砂の補充:あり");
if (document.getElementById("sand_no").checked) toilet.push("砂の補充:なし");

document.getElementById("pdf_toilet").innerText = toilet.join("・");

    // 食事
    let food = [];
    if (document.getElementById("food_dry").checked) food.push("ドライ");
    if (document.getElementById("food_wet").checked) food.push("ウェット");
    let foodNote = document.getElementById("food_note").value;
    document.getElementById("pdf_food").innerText = food.join("・") + " " + foodNote;

    const snack = document.querySelector("input[name='snack']:checked");
    document.getElementById("pdf_snack").innerText =
      (snack ? snack.nextElementSibling.innerText : "") +
      " " + document.getElementById("snack_note").value;

    const water = document.querySelector("input[name='water']:checked");
    document.getElementById("pdf_water").innerText =
      (water ? water.nextElementSibling.innerText : "") +
      " " + document.getElementById("water_note").value;

	  // ケア
	  const walk = document.querySelector("input[name='walk']:checked");
	  document.getElementById("pdf_walk").innerText =
	    walk ? walk.nextElementSibling.innerText : "";

	  const brush = document.querySelector("input[name='brush']:checked");
	  document.getElementById("pdf_brush").innerText =
	    brush ? brush.nextElementSibling.innerText : "";

	  const fur = document.querySelector("input[name='fur']:checked");
	  document.getElementById("pdf_fur").innerText =
	    fur ? fur.nextElementSibling.innerText : "";

	  const meds = document.querySelector("input[name='meds']:checked");
	  document.getElementById("pdf_meds").innerText =
	    meds ? meds.nextElementSibling.innerText : "";

	  const topical = document.querySelector("input[name='topical']:checked");
	  document.getElementById("pdf_topical").innerText =
	    topical ? topical.nextElementSibling.innerText : "";

	  const nail = document.querySelector("input[name='nail']:checked");
	  document.getElementById("pdf_nail").innerText =
	    nail ? nail.nextElementSibling.innerText : "";
	  
	  const tooth = document.querySelector("input[name='tooth']:checked");
      document.getElementById("pdf_tooth").innerText =
      tooth ? tooth.nextElementSibling.innerText : "";

  
    // MEMO
    document.getElementById("pdf_memo").innerText = document.getElementById("memo").value;

    // ✅ PDF変換対象を「pdfContent」にする
    const target = document.getElementById("pdfContent");
    target.style.display = "block"; // 一時表示

   const canvas = await html2canvas(target, { scale: 2, useCORS: true });
const imgData = canvas.toDataURL("image/png");

const pdf = new jsPDF("p", "mm", "a4");

const pageWidth = 210;
const pageHeight = 297;

const imgWidth = pageWidth;
const imgHeight = (canvas.height * imgWidth) / canvas.width;

let heightLeft = imgHeight;
let position = 0;

// 1ページ目
pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
heightLeft -= pageHeight;

// ページ分割（境界が太くならない調整）
while (heightLeft > 0) {
  pdf.addPage();
  position -= pageHeight;
  pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
  heightLeft -= pageHeight;
}

pdf.save("thumbelina_record.pdf");

    target.style.display = "none"; // 再び隠す
  }
  </script>


</body>
</html>
