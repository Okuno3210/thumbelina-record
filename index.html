<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>サービス実施記録（Thumbelina／スマホ版）</title>

<!-- PDF生成ライブラリ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  :root { --gap:12px; --radius:10px; --border:1px solid #ddd; }
  * { box-sizing:border-box; }
  body { font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue","Hiragino Kaku Gothic ProN",Meiryo,sans-serif; margin:0; padding:20px; line-height:1.5; color:#222; background:#fafafa; }
  h1 { font-size:1.2rem; margin:0 0 14px; }
  .card { background:#fff; border:var(--border); border-radius:var(--radius); padding:14px; margin-bottom:16px; box-shadow:0 1px 2px rgba(0,0,0,.04); }
  .row { display:grid; grid-template-columns:1fr; gap:var(--gap); }
  .grid-3 { grid-template-columns:repeat(3,minmax(0,1fr)); }
  .field label { font-weight:600; display:block; margin-bottom:4px; }
  .inline { display:flex; flex-wrap:wrap; gap:10px 14px; align-items:center; }
  .inline .group { display:inline-flex; align-items:center; gap:8px; }
  input[type="text"], input[type="number"], input[type="datetime-local"], textarea {
    width:100%; border:var(--border); border-radius:8px; padding:10px 12px; font-size:16px; background:#fff;
  }
  textarea { min-height:120px; resize:vertical; }
  .btn { appearance:none; border:none; border-radius:10px; padding:12px 16px; font-size:16px; font-weight:700; cursor:pointer; }
  .btn-primary { background:#0d6efd; color:#fff; width:100%; margin-top:20px; }
  .chip { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:#f2f4f7; border:1px solid #e6e9ef; }
  .text-right { text-align:right; }

  /* PDF用レイアウト */
  #pdf_memo, #pdf2_memo { display:block; white-space:pre-wrap; line-height:1.6; }
  .pdf-weather-row { display:grid; grid-template-columns:repeat(4,1fr); gap:20px; margin-bottom:20px; align-items:center; }
  .pdf-weather-row div, .pdf-two-row div { display:flex; gap:6px; white-space:nowrap; }
  .pdf-two-row { display:flex; gap:40px; align-items:center; margin-bottom:20px; }
  @media print { @page{ margin:0; } .btn-primary { display:none; } .card { box-shadow:none; border-color:#bbb; } body { background:#fff; padding:0; } }
</style>
</head>
<body>
  <h1>サービス実施記録（Thumbelina／スマホ版）</h1>

  <form id="recordForm">
    <!-- 基本情報 -->
    <div class="card">
      <div class="row">
        <div class="field">
          <label for="name">お名前</label>
          <input id="name" name="name" type="text" placeholder="ペットのお名前">
        </div>
        <div class="field">
          <label for="enter_time">入室時間</label>
          <input id="enter_time" name="enter_time" type="datetime-local">
        </div>
        <div class="field">
          <label for="exit_time">退室時間</label>
          <input id="exit_time" name="exit_time" type="datetime-local">
        </div>
      </div>
    </div>

    <!-- 天候・環境 -->
    <div class="card">
      <div class="section-title">天候・環境</div>
      <div class="row">
        <div class="inline">
          <span class="chip"><input type="checkbox" id="weather_sunny"><label for="weather_sunny">晴れ</label></span>
          <span class="chip"><input type="checkbox" id="weather_cloudy"><label for="weather_cloudy">くもり</label></span>
          <span class="chip"><input type="checkbox" id="weather_rainy"><label for="weather_rainy">雨</label></span>
        </div>
        <div class="row grid-3">
          <div class="field"><label for="temp_out">外気温（℃）</label><input id="temp_out" type="number" inputmode="decimal" step="0.1" placeholder="例）25.5"></div>
          <div class="field"><label for="temp_in">室温（℃）</label><input id="temp_in" type="number" inputmode="decimal" step="0.1"></div>
          <div class="field"><label for="humidity">湿度（％）</label><input id="humidity" type="number" inputmode="numeric" step="1" min="0" max="100"></div>
        </div>
      </div>
    </div>

    <!-- サービス -->
    <div class="card">
      <div class="section-title">サービスの種類</div>
      <div class="inline">
        <span class="chip"><input type="radio" id="service_0" name="service" value="30"><label for="service_0">シッティング30分</label></span>
        <span class="chip"><input type="radio" id="service_1" name="service" value="60"><label for="service_1">シッティング60分</label></span>
        <span class="chip"><input type="radio" id="service_2" name="service" value="90"><label for="service_2">シッティング90分</label></span>
        <span class="chip"><input type="radio" id="service_3" name="service" value="120"><label for="service_3">シッティング120分</label></span>
        <span class="chip"><input type="radio" id="service_other_chk" name="service" value="other"><label for="service_other_chk">その他</label></span>
        <input id="service_other_text" type="text" placeholder="その他：内容を記入" aria-label="その他内容" style="flex:1; min-width:200px;">
      </div>
    </div>

    <!-- 排泄 -->
    <div class="card">
      <div class="section-title">排泄</div>
      <div class="row">
        <div class="field">
          <label>おしっこ</label>
          <div class="inline">
            <span class="group"><input type="radio" id="pee_low" name="pee" value="少量"><label for="pee_low">少量</label></span>
            <span class="group"><input type="radio" id="pee_mid" name="pee" value="中量"><label for="pee_mid">中量</label></span>
            <span class="group"><input type="radio" id="pee_high" name="pee" value="多量"><label for="pee_high">多量</label></span>
            <span class="group"><input type="radio" id="pee_none" name="pee" value="なし"><label for="pee_none">なし</label></span>
            <input type="text" id="pee_note" placeholder="メモ（色・回数など）">
          </div>
        </div>

        <div class="field">
          <label>うんち</label>
          <div class="inline">
            <span class="group"><input type="radio" id="poo_low" name="poo" value="少量"><label for="poo_low">少量</label></span>
            <span class="group"><input type="radio" id="poo_mid" name="poo" value="中量"><label for="poo_mid">中量</label></span>
            <span class="group"><input type="radio" id="poo_high" name="poo" value="多量"><label for="poo_high">多量</label></span>
            <span class="group"><input type="radio" id="poo_none" name="poo" value="なし"><label for="poo_none">なし</label></span>
            <input type="text" id="poo_note" placeholder="メモ（状態・回数など）">
          </div>
        </div>

        <div class="inline">
          <span class="chip"><input type="checkbox" id="toilet_clean_yes" value="実施"><label for="toilet_clean_yes">トイレ掃除：実施</label></span>
          <span class="chip"><input type="checkbox" id="toilet_clean_no"  value="未実施"><label for="toilet_clean_no">トイレ掃除：未実施</label></span>
          <span class="chip"><input type="checkbox" id="sheet_yes" value="あり"><label for="sheet_yes">シート交換：あり</label></span>
          <span class="chip"><input type="checkbox" id="sheet_no"  value="なし"><label for="sheet_no">シート交換：なし</label></span>
          <span class="chip"><input type="checkbox" id="sand_yes"  value="あり"><label for="sand_yes">砂の補充：あり</label></span>
          <span class="chip"><input type="checkbox" id="sand_no"   value="なし"><label for="sand_no">砂の補充：なし</label></span>
        </div>
      </div>
    </div>

    <!-- 食事・水分 -->
    <div class="card">
      <div class="section-title">食事・水分</div>
      <div class="row">
        <div class="field">
          <label>ごはん</label>
          <div class="inline">
            <span class="group"><input type="checkbox" id="food_dry"><label for="food_dry">ドライ</label></span>
            <span class="group"><input type="checkbox" id="food_wet"><label for="food_wet">ウェット</label></span>
            <input type="text" id="food_note" placeholder="銘柄・量など">
          </div>
        </div>
        <div class="field">
          <label>おやつ</label>
          <div class="inline">
            <span class="group"><input type="radio" id="snack_all" name="snack" value="あり"><label for="snack_all">あり</label></span>
            <span class="group"><input type="radio" id="snack_none" name="snack" value="なし"><label for="snack_none">なし</label></span>
            <input type="text" id="snack_note" placeholder="内容・量など">
          </div>
        </div>
        <div class="field">
          <label>お水</label>
          <div class="inline">
            <span class="group"><input type="radio" id="water_changed" name="water" value="交換済み"><label for="water_changed">交換済み</label></span>
            <span class="group"><input type="radio" id="water_not" name="water" value="未交換"><label for="water_not">未交換</label></span>
            <input type="text" id="water_note" placeholder="器の数・場所など">
          </div>
        </div>
      </div>
    </div>

    <!-- ケア -->
    <div class="card">
      <div class="section-title">ケア</div>
      <div class="row">
        <div class="inline">
          <span class="chip"><input type="radio" id="walk_done" name="walk" value="実施"><label for="walk_done">お散歩：実施</label></span>
          <span class="chip"><input type="radio" id="walk_none" name="walk" value="未実施"><label for="walk_none">お散歩：未実施</label></span>
        </div>
        <div class="inline">
          <span class="chip"><input type="radio" id="brush_yes" name="brush" value="実施"><label for="brush_yes">ブラッシング：実施</label></span>
          <span class="chip"><input type="radio" id="brush_no"  name="brush" value="未実施"><label for="brush_no">ブラッシング：未実施</label></span>
          <span class="group" style="margin-left:6px;">
            <span class="muted">抜け毛の量</span>
            <span class="group"><input type="radio" id="fur_low" name="fur" value="少量"><label for="fur_low">少量</label></span>
            <span class="group"><input type="radio" id="fur_mid" name="fur" value="中量"><label for="fur_mid">中量</label></span>
            <span class="group"><input type="radio" id="fur_high" name="fur" value="多量"><label for="fur_high">多量</label></span>
          </span>
        </div>
        <div class="inline">
          <span class="chip"><input type="radio" id="meds_done" name="meds" value="済み"><label for="meds_done">服薬：済み</label></span>
          <span class="chip"><input type="radio" id="meds_none" name="meds" value="なし"><label for="meds_none">服薬：なし</label></span>
          <span class="chip"><input type="radio" id="topical_done" name="topical" value="済み"><label for="topical_done">塗布薬：済み</label></span>
          <span class="chip"><input type="radio" id="topical_none" name="topical" value="なし"><label for="topical_none">塗布薬：なし</label></span>
          <span class="chip"><input type="radio" id="nail_done" name="nail" value="実施"><label for="nail_done">爪切り：実施</label></span>
          <span class="chip"><input type="radio" id="nail_none" name="nail" value="未実施"><label for="nail_none">爪切り：未実施</label></span>
          <span class="chip"><input type="radio" id="tooth_done" name="tooth" value="実施"><label for="tooth_done">歯磨き：実施</label></span>
          <span class="chip"><input type="radio" id="tooth_none" name="tooth" value="未実施"><label for="tooth_none">歯磨き：未実施</label></span>
        </div>
      </div>
    </div>

    <!-- MEMO -->
    <div class="card">
      <div class="section-title">MEMO</div>
      <textarea id="memo" placeholder="全体のご様子・特記事項など"></textarea>
    </div>

    <h2 class="text-right">ペットの訪問介護・Thumbelina</h2>

    <button type="button" class="btn btn-primary" onclick="saveAsPDF()">PDFとして保存</button>

    <!-- ✅ PDF: 1ページ目（天候〜排泄） -->
    <div id="pdfContent" style="display:none; width:794px; min-height:1123px; padding:80px 40px; font-size:24px; line-height:1.6; background:#fff;">
      <h2>サービス実施記録</h2>
      <p><strong>お名前：</strong> <span id="pdf_name"></span></p>
      <p><strong>入室時間：</strong> <span id="pdf_enter_time"></span></p>
      <p><strong>退室時間：</strong> <span id="pdf_exit_time"></span></p>

      <h3>天候・環境</h3>
      <div class="pdf-weather-row">
        <div><strong>天候：</strong><span id="pdf_weather"></span></div>
        <div><strong>外気温：</strong><span id="pdf_temp_out"></span></div>
        <div><strong>室温：</strong><span id="pdf_temp_in"></span></div>
        <div><strong>湿度：</strong><span id="pdf_humidity"></span></div>
      </div>

      <h3>サービスの種類</h3>
      <p id="pdf_service"></p>

      <h3>排泄</h3>
      <p><strong>おしっこ：</strong> <span id="pdf_pee"></span></p>
      <p><strong>うんち：</strong> <span id="pdf_poo"></span></p>
      <p><strong>その他ケア：</strong> <span id="pdf_toilet"></span></p>
    </div>

    <!-- ✅ PDF: 2ページ目（食事・水分、ケア、MEMO） -->
    <div id="pdfContent2" style="display:none; width:794px; min-height:1123px; padding:80px 40px; font-size:24px; line-height:1.6; background:#fff;">
      <h3>食事・水分</h3>
      <p><strong>ごはん：</strong> <span id="pdf2_food"></span></p>
      <p><strong>おやつ：</strong> <span id="pdf2_snack"></span></p>
      <p><strong>お水：</strong> <span id="pdf2_water"></span></p>

      <h3>ケア</h3>
      <p><strong>お散歩：</strong> <span id="pdf2_walk"></span></p>

      <div class="pdf-two-row">
        <div><strong>ブラッシング：</strong><span id="pdf2_brush"></span></div>
        <div><strong>抜け毛：</strong><span id="pdf2_fur"></span></div>
      </div>

      <div class="pdf-two-row">
        <div><strong>服薬：</strong><span id="pdf2_meds"></span></div>
        <div><strong>塗布薬：</strong><span id="pdf2_topical"></span></div>
      </div>

      <div class="pdf-two-row">
        <div><strong>爪切り：</strong><span id="pdf2_nail"></span></div>
        <div><strong>歯磨き：</strong><span id="pdf2_tooth"></span></div>
      </div>

      <h3>MEMO</h3>
      <p id="pdf2_memo"></p>

      <p style="text-align:right; margin-top:40px;">ペットの訪問介護・Thumbelina</p>
    </div>
  </form>

  <script>
  async function saveAsPDF() {
    const { jsPDF } = window.jspdf;

    // ===== 値の流し込み =====
    // 1ページ目
    document.getElementById("pdf_name").innerText       = document.getElementById("name").value || "";
    document.getElementById("pdf_enter_time").innerText  = document.getElementById("enter_time").value || "";
    document.getElementById("pdf_exit_time").innerText   = document.getElementById("exit_time").value || "";

    const weather = [];
    if (document.getElementById("weather_sunny").checked)  weather.push("晴れ");
    if (document.getElementById("weather_cloudy").checked) weather.push("くもり");
    if (document.getElementById("weather_rainy").checked)  weather.push("雨");
    document.getElementById("pdf_weather").innerText = weather.join("・");

    const outT = document.getElementById("temp_out").value;
    const inT  = document.getElementById("temp_in").value;
    const hum  = document.getElementById("humidity").value;
    document.getElementById("pdf_temp_out").innerText = outT ? outT + "℃" : "";
    document.getElementById("pdf_temp_in").innerText  = inT  ? inT  + "℃" : "";
    document.getElementById("pdf_humidity").innerText = hum  ? hum  + "%"  : "";

    const svc = document.querySelector("input[name='service']:checked");
    let svcText = svc ? (svc.value === "other" ? document.getElementById("service_other_text").value : svc.nextElementSibling.innerText) : "";
    document.getElementById("pdf_service").innerText = svcText;

    const pee = document.querySelector("input[name='pee']:checked");
    document.getElementById("pdf_pee").innerText = (pee ? pee.nextElementSibling.innerText : "") + (document.getElementById("pee_note").value ? " " + document.getElementById("pee_note").value : "");

    const poo = document.querySelector("input[name='poo']:checked");
    document.getElementById("pdf_poo").innerText = (poo ? poo.nextElementSibling.innerText : "") + (document.getElementById("poo_note").value ? " " + document.getElementById("poo_note").value : "");

    const toilet = [];
    if (document.getElementById("toilet_clean_yes").checked) toilet.push("トイレ掃除:実施");
    if (document.getElementById("toilet_clean_no").checked)  toilet.push("トイレ掃除:未実施");
    if (document.getElementById("sheet_yes").checked)        toilet.push("シート交換:あり");
    if (document.getElementById("sheet_no").checked)         toilet.push("シート交換:なし");
    if (document.getElementById("sand_yes").checked)         toilet.push("砂の補充:あり");
    if (document.getElementById("sand_no").checked)          toilet.push("砂の補充:なし");
    document.getElementById("pdf_toilet").innerText = toilet.join("・");

    // 2ページ目（※IDは pdf2_〜）
    const food = [];
    if (document.getElementById("food_dry").checked) food.push("ドライ");
    if (document.getElementById("food_wet").checked) food.push("ウェット");
    document.getElementById("pdf2_food").innerText =
      [food.join("・"), document.getElementById("food_note").value].filter(Boolean).join(" ");

    const snack = document.querySelector("input[name='snack']:checked");
    document.getElementById("pdf2_snack").innerText =
      [(snack ? snack.nextElementSibling.innerText : ""), document.getElementById("snack_note").value].filter(Boolean).join(" ");

    const water = document.querySelector("input[name='water']:checked");
    document.getElementById("pdf2_water").innerText =
      [(water ? water.nextElementSibling.innerText : ""), document.getElementById("water_note").value].filter(Boolean).join(" ");

    const walk = document.querySelector("input[name='walk']:checked");
    document.getElementById("pdf2_walk").innerText = walk ? walk.nextElementSibling.innerText : "";

    const brush = document.querySelector("input[name='brush']:checked");
    document.getElementById("pdf2_brush").innerText = brush ? brush.nextElementSibling.innerText : "";

    const fur = document.querySelector("input[name='fur']:checked");
    document.getElementById("pdf2_fur").innerText = fur ? fur.nextElementSibling.innerText : "";

    const meds = document.querySelector("input[name='meds']:checked");
    document.getElementById("pdf2_meds").innerText = meds ? meds.nextElementSibling.innerText : "";

    const topical = document.querySelector("input[name='topical']:checked");
    document.getElementById("pdf2_topical").innerText = topical ? topical.nextElementSibling.innerText : "";

    const nail = document.querySelector("input[name='nail']:checked");
    document.getElementById("pdf2_nail").innerText = nail ? nail.nextElementSibling.innerText : "";

    const tooth = document.querySelector("input[name='tooth']:checked");
    document.getElementById("pdf2_tooth").innerText = tooth ? tooth.nextElementSibling.innerText : "";

    document.getElementById("pdf2_memo").innerText = document.getElementById("memo").value || "";

    // ===== PDF化（1ページ目 → 2ページ目）=====
    const pdf = new jsPDF("p", "mm", "a4");
    const imgWidth = 210;

    // ページ1
    const p1 = document.getElementById("pdfContent");
    p1.style.display = "block";
    const c1 = await html2canvas(p1, { scale: 2 });
    const h1 = (c1.height * imgWidth) / c1.width;
    pdf.addImage(c1.toDataURL("image/png"), "PNG", 0, 0, imgWidth, h1);
    p1.style.display = "none";

    // ページ2
    const p2 = document.getElementById("pdfContent2");
    p2.style.display = "block";
    const c2 = await html2canvas(p2, { scale: 2 });
    const h2 = (c2.height * imgWidth) / c2.width;
    pdf.addPage();
    pdf.addImage(c2.toDataURL("image/png"), "PNG", 0, 0, imgWidth, h2);
    p2.style.display = "none";

    // 保存
    pdf.save("thumbelina_record.pdf");
  }
  </script>
</body>
</html>
